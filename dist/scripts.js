let pokemonRepository=(function(){let pokemonList=[];let apiUrl='https://pokeapi.co/api/v2/pokemon/?limit=150';let modalContainer=document.querySelector('#modal-container');function add(pokemon){if(typeof pokemon==="object"&&"name"in pokemon){pokemonList.push(pokemon);}else{console.log("pokemon is not correct");}}
function getAll(){return pokemonList;}
function loadDetails(item){let url=item.detailsUrl;return fetch(url).then(function(response){return response.json();}).then(function(details){item.imageUrl=details.sprites.other.dream_world.front_default;item.height=details.height;item.weight=details.weight;item.abilities=details.abilities.map(function(ability){return ability.ability.name;}).join(', ');item.buttonImage=details.sprites.front_default;item.types=details.types.map(function(type){return type.type.name;}).join(', ');}).catch(function(e){console.error(e);});}
function addListItem(pokemon){let pokemonList=document.querySelector(".pokemon-list");let listPokemon=document.createElement("li");listPokemon.classList.add("list-group-item");let button=document.createElement("button");let pokemonImage=document.createElement("img");pokemonImage.classList.add("button_pokemon_image");button.classList.add("button-class","btn","btn-primary");button.setAttribute("data-target","#exampleModal");button.setAttribute("data-toggle","modal");button.setAttribute("type","button");fetch(pokemon.detailsUrl).then((response)=>response.json()).then((data)=>{button.innerHTML=`<span>${pokemon.name}</span><img src="${data.sprites.front_shiny}"/>`;}).catch((err)=>console.log("Err: ",err));listPokemon.appendChild(button);button.appendChild(pokemonImage);pokemonImage.setAttribute("alt","Image of "+pokemon.name);pokemonList.appendChild(listPokemon);addEventListenerButton(button,pokemon);}
function addEventListenerButton(button,pokemon){button.addEventListener("click",function(){loadDetails(pokemon).then(function(){showModal(pokemon);});});}
function loadList(){return fetch(apiUrl).then(function(response){return response.json();}).then(function(json){json.results.forEach(function(item){let pokemon={name:item.name,detailsUrl:item.url};add(pokemon);console.log(pokemon);});}).catch(function(e){console.error(e);})}
function showDetails(pokemon){console.log(pokemon);const dialog=document.querySelector('dialog');dialog.showModal(pokemon);}
function showModal(pokemon){let modalBody=$(".modal-body");let modalTitle=$(".modal-title");let modalHeader=$(".modal-header");modalTitle.empty();modalBody.empty();let nameElement=$("<h1>"+pokemon.name+"</h1>");let imageElement=$('<img class="modal-img mx-auto d-block img-fluid" style="height:400px" "width:400px">');imageElement.attr("src",pokemon.imageUrl);let heightElement=$("<p>"+"height : "+pokemon.height+"</p>");let weightElement=$("<p>"+"weight : "+pokemon.weight+"</p>");let typesElement=$("<p>"+"types : "+pokemon.types+" "+"</p>");let abilitiesElement=$("<p>"+"abilities : "+pokemon.abilities+" "+"</p>")
modalTitle.append(nameElement);modalBody.append(imageElement);modalBody.append(heightElement);modalBody.append(weightElement);modalBody.append(typesElement);modalBody.append(abilitiesElement);};document.getElementById("searchBar").addEventListener("input",function(){let=query=this.value.toLowerCase();let pokemonListElement=document.querySelector(".pokemon-list");pokemonListElement.innerHTML="";if(query==""){pokemonRepository.getAll().forEach(function(pokemon){pokemonRepository.addListItem(pokemon);});}
else{let matchingPokemon=pokemonRepository.findByName(query);matchingPokemon.forEach(function(pokemon){pokemonRepository.addListItem(pokemon);});}});function findByName(name){let matchingPokemon=pokemonList.filter(function(pokemon){return pokemon.name.toLowerCase().includes(query.toLowerCase());});return matchingPokemon;}
return{add:add,getAll:getAll,findByName:findByName,addListItem:addListItem,showDetails:showDetails,addEventListenerButton:addEventListenerButton,loadList:loadList,loadDetails:loadDetails,showModal:showModal,};})();pokemonRepository.loadList().then(function(){pokemonRepository.getAll().forEach(function(pokemon){pokemonRepository.addListItem(pokemon);});});